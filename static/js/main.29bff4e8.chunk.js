(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{14:function(e,t,a){e.exports=a(25)},19:function(e,t,a){},20:function(e,t,a){},25:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(10),l=a.n(r),i=(a(19),a(11)),c=a(3),u=a(4),m=a(6),s=a(5),d=a(2),h=a(7),b=(a(20),a(1)),g=function(e,t,a){var n=Object(b.Decimal)(t.end_equity-t.beg_equity).div(a-1),o=Object(b.Decimal)(t.end_bond-t.beg_bond).div(a-1),r=function(e,t){for(var a=e.equity,n=e.bond,o=Math.min(n.length,a.length)-1,r=[],l=[],i=0;i<12*t;i+=1){var c=Math.floor(Math.random()*(o+1));r.push(n[n.length-c-1]),l.push(a[a.length-c-1])}return{bond:r,equity:l}}(e,a);return r.equity.map(function(e,l){var i=l<a?Object(b.Decimal)(t.beg_equity).plus(n.times(l)):Object(b.Decimal)(t.end_equity),c=l<a?Object(b.Decimal)(t.beg_bond).plus(o.times(l)):Object(b.Decimal)(t.end_bond),u=Object(b.Decimal)(r.equity[l]).div(100).times(i),m=Object(b.Decimal)(r.bond[l]).div(100).times(c);return u.plus(m)})},f=function(e,t){if(e.length+1!==t.length)throw new Error("Invalid input - cashflows must equal the length of returns");var a=[Object(b.Decimal)(t[0])];return t.reduce(function(t,n,o){var r=Object(b.Decimal)("1").add(e[o-1]),l=Object(b.Decimal)(t).times(r),i=b.Decimal.max(l.plus(n),0);return a.push(i),i}),a},p=function(e){return new Promise(function(t){for(var a=function(e,t,a,n,o){var r=Array(12*a+1).fill(0),l=12*t;return r.map(function(t,a){return 0===a?e:a<=l?Object(b.Decimal)(n):Object(b.Decimal)(o).div("-12")})}(e.savings,e.years_to_ret,e.duration,e.contribution,e.ret_income),n=[],o=JSON.parse(window.localStorage.getItem("asset_data")),r=0;r<100;r+=1){var l=g(o,e.allocation,e.duration);n.push(f(l,a))}t(n.sort(function(e,t){return e[e.length-1]-t[t.length-1]}))})},v=function(e){var t=e.reduce(function(e,t){return e+(0===parseInt(t[t.length-1])?1:0)},0),a=Object(b.Decimal)(t).div(e.length/100);return Object(b.Decimal)(100).minus(a).toString()},y=function(e){for(var t=Object(b.Decimal)(0),a=Object(b.Decimal)(-1/0),n=0;n<e.length;n+=1){var o=(a=e[n].greaterThan(a)?e[n]:a).minus(e[n]).div(a).times(100);t=o.greaterThan(t)?o:t}return t.toDecimalPlaces(2).toString()},E=a(12),j=a.n(E),O=a(13),w=a.n(O),S=function(e){return o.a.createElement("div",{id:"form-group row"},o.a.createElement("label",{className:"",htmlFor:e.name},o.a.createElement("h5",null,e.title,": ")),o.a.createElement(w.a,{value:e.value,name:e.name,id:e.name,className:"form-control",options:{numeral:!0,numeralThousandsGroupStyle:"thousand"},onChange:e.onChange}))},_=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(m.a)(this,Object(s.a)(t).call(this,e))).myRef=o.a.createRef(),a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){setTimeout(function(){document.querySelector(".js-plotly-plot").scrollIntoView({behavior:"smooth"})},10)}},{key:"render",value:function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(C,{data:this.props.data,duration:this.props.duration}),o.a.createElement(D,{data:this.props.data}))}}]),t}(o.a.Component),C=function(e){var t=Array.from({length:12*e.duration+1},function(e,t){return t/12}),a=[{x:t,y:e.data.median.map(function(e){return parseInt(e.toString())}),type:"scatter",name:"50th Percentile"},{x:t,y:e.data.buttom10.map(function(e){return parseInt(e.toString())}),type:"scatter",name:"10th Percentile"},{x:t,y:e.data.top10.map(function(e){return parseInt(e.toString())}),type:"scatter",name:"90th Percentile"}];return o.a.createElement(j()(Plotly),{data:a,config:{displaylogo:!1,displayModeBar:!1,scrollZoom:!1},layout:{title:{text:"Simulated Portfolio Balances"},legend:{orientation:"h"},autosize:!0,margin:{r:30,l:40,t:80,b:40}},useResizeHandler:!0,style:{width:"100%",height:"100%",overflow:"auto"}})},D=function(e){var t=e.data.median.length;return b.Decimal.set({rounding:0}),o.a.createElement("div",{className:"table-responsive"},o.a.createElement("table",{className:"table table-striped table-hover"},o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",{scope:"col"}),o.a.createElement("th",{scope:"col"},"10th Percentile "),o.a.createElement("th",{scope:"col"},"50th Percentile "),o.a.createElement("th",{scope:"col"},"90th Percentile "))),o.a.createElement("tbody",null,o.a.createElement("tr",null,o.a.createElement("th",{scope:"row"},"Ending Balance"),o.a.createElement("td",null,Intl.NumberFormat().format(e.data.buttom10[t-1].round())," "),o.a.createElement("td",null,Intl.NumberFormat().format(e.data.median[t-1].round())," "),o.a.createElement("td",null,Intl.NumberFormat().format(e.data.top10[t-1].round())," ")),o.a.createElement("tr",null,o.a.createElement("th",{scope:"row"},"Maximum Drawdown"),o.a.createElement("td",null,"-".concat(y(e.data.buttom10),"%")," "),o.a.createElement("td",null,"-".concat(y(e.data.median),"%")),o.a.createElement("td",null,"-".concat(y(e.data.top10),"%")," ")))))},N=function(e){function t(){return Object(c.a)(this,t),Object(m.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){setTimeout(this.props.handler,50)}},{key:"render",value:function(){return o.a.createElement("button",{type:"submit",id:"submit-btm",className:"btn btn-primary",disabled:!0},o.a.createElement("i",{className:"fas fa-spinner"})," Simulating")}}]),t}(o.a.Component),k=function(e){var t;t=e.state.savings,(new Intl.NumberFormat).format(t);return o.a.createElement("form",{className:"form-horizontal",onSubmit:e.handleSubmit},o.a.createElement(S,{name:"years_to_ret",value:e.state.years_to_ret,onChange:e.handler,title:"Years to Retirement"}),o.a.createElement(S,{name:"duration",value:e.state.duration,onChange:e.handler,title:"Duration of Simulation"}),o.a.createElement(S,{name:"savings",value:e.state.savings,onChange:e.handler,title:"Current Savings"}),o.a.createElement(S,{name:"contribution",value:e.state.contribution,onChange:e.handler,title:"Monthly Contribution until Retirement"}),o.a.createElement(S,{name:"ret_income",value:e.state.ret_income,onChange:e.handler,title:"Target Annual Retirement Income"}),o.a.createElement(S,{name:"beg_equity",value:e.state.allocation.beg_equity,onChange:e.handleAllocChange,title:"Current Equity Allocation (%)"}),o.a.createElement(S,{name:"beg_bond",value:e.state.allocation.beg_bond,onChange:e.handleAllocChange,title:"Current Fixed Income Allocation (%)"}),o.a.createElement(S,{name:"end_equity",value:e.state.allocation.end_equity,onChange:e.handleAllocChange,title:"Final Equity Allocation (%)"}),o.a.createElement(S,{name:"end_bond",value:e.state.allocation.end_bond,onChange:e.handleAllocChange,title:"Final Fixed Income Allocation (%)"}),o.a.createElement("div",{id:"logger"}),e.state.loading?o.a.createElement(N,{data:e.state,handler:e.handleSim}):o.a.createElement("button",{type:"submit",id:"submit-btn",className:"btn btn-primary"},"Simulate!"))},q=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(m.a)(this,Object(s.a)(t).call(this,e))).handleSubmit=a.handleSubmit.bind(Object(d.a)(a)),a.handleChange=a.handleChange.bind(Object(d.a)(a)),a.handleAllocChange=a.handleAllocChange.bind(Object(d.a)(a)),a.handleSim=a.handleSim.bind(Object(d.a)(a)),a.state={loaded:!1,loading:!1,years_to_ret:"30",duration:"50",savings:"50000",contribution:"1000",ret_income:"100000",allocation:{beg_equity:"60",beg_bond:"40",end_equity:"20",end_bond:"80"},returns:[],outcomes:{}},a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){fetch("https://calc-project.herokuapp.com/api/index/").then(function(e){if(!e.ok)throw new Error("Network response was not ok.");return e.json()}).then(function(e){var t=[],a=[];if(e.forEach(function(e){"SPX"===e.index_name?t.push(e.mo_return):a.push(e.mo_return)}),a.length<1||t.length<1)throw new Error("API call returned no data");var n={bond:a,equity:t};window.localStorage.setItem("asset_data",JSON.stringify(n))}).catch(function(e){console.log(e),document.getElementById("logger").innerHTML=e})}},{key:"handleSim",value:function(){var e=this;p(this.state).then(function(t){window.localStorage.setItem("scenarios",JSON.stringify(t)),e.setState({loaded:!0,loading:!1,outcomes:{median:t[Math.floor(t.length/2)],buttom10:t[Math.floor(t.length/10)],top10:t[Math.floor(t.length/10*9)],survival:v(t)}})})}},{key:"handleSubmit",value:function(e){e.preventDefault(),this.setState({loading:!0})}},{key:"handleChange",value:function(e){var t=e.target.name,a=Math.max(e.target.rawValue,0),n=Number.isNaN(a)?this.state[t]:a;this.setState(Object(i.a)({},t,n.toString()))}},{key:"handleAllocChange",value:function(e){var t=e.target.name,a=Math.max(e.target.rawValue,0),n=this.state.allocation;n[t]=a.toString(),this.setState({allocation:n})}},{key:"render",value:function(){return o.a.createElement("div",{className:"container-fluid"},o.a.createElement("p",null,"A Monte Carlo simulator to project your future financial position, given your individual parameters and historical market performance. This simulation supports dynamic changes to asset allocation throughout the simulation period. "),o.a.createElement("p",null,"This project is for illustrative purposes only. This tool should not be used for financial or investment advice. This tool has not been subject to rigorous testing and may contain errors."),o.a.createElement(k,{handleSubmit:this.handleSubmit,handler:this.handleChange,state:this.state,handleAllocChange:this.handleAllocChange,handleSim:this.handleSim}),this.state.loaded&&o.a.createElement(_,{title:this.state.outcomes.survival,data:this.state.outcomes,duration:this.state.duration}))}}]),t}(o.a.Component);var I=function(){return o.a.createElement("div",{className:"container"},o.a.createElement(q,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(o.a.createElement(I,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[14,1,2]]]);
//# sourceMappingURL=main.29bff4e8.chunk.js.map