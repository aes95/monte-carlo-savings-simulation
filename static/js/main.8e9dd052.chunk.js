(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{12:function(e,t,n){e.exports=n(23)},18:function(e,t,n){},19:function(e,t,n){},23:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),l=n(9),r=n.n(l),i=(n(18),n(10)),c=n(3),u=n(4),m=n(6),s=n(5),d=n(2),h=n(7),b=(n(19),n(1)),g=function(e,t,n){var a=Object(b.Decimal)(t.end_equity-t.beg_equity).div(n-1),o=Object(b.Decimal)(t.end_bond-t.beg_bond).div(n-1),l=function(e,t){for(var n=e.equity,a=e.bond,o=Math.min(a.length,n.length)-1,l=[],r=[],i=0;i<12*t;i+=1){var c=Math.floor(Math.random()*(o+1));l.push(a[a.length-c-1]),r.push(n[n.length-c-1])}return{bond:l,equity:r}}(e,n);return l.equity.map(function(e,r){var i=r<n?Object(b.Decimal)(t.beg_equity).plus(a.times(r)):Object(b.Decimal)(t.end_equity),c=r<n?Object(b.Decimal)(t.beg_bond).plus(o.times(r)):Object(b.Decimal)(t.end_bond),u=Object(b.Decimal)(l.equity[r]).div(100).times(i),m=Object(b.Decimal)(l.bond[r]).div(100).times(c);return u.plus(m)})},f=function(e,t){if(e.length+1!==t.length)throw new Error("Invalid input - cashflows must equal the length of returns");var n=[Object(b.Decimal)(t[0])];return t.reduce(function(t,a,o){var l=Object(b.Decimal)("1").add(e[o-1]),r=Object(b.Decimal)(t).times(l),i=b.Decimal.max(r.plus(a),0);return n.push(i),i}),n},v=function(e){return new Promise(function(t){for(var n=function(e,t,n,a,o){var l=Array(12*n+1).fill(0),r=12*t;return l.map(function(t,n){return 0===n?e:n<=r?Object(b.Decimal)(a):Object(b.Decimal)(o).div("-12")})}(e.savings,e.years_to_ret,e.duration,e.contribution,e.ret_income),a=[],o=JSON.parse(window.localStorage.getItem("asset_data")),l=0;l<100;l+=1){var r=g(o,e.allocation,e.duration);a.push(f(r,n))}t(a.sort(function(e,t){return e[e.length-1]-t[t.length-1]}))})},p=function(e){var t=e.reduce(function(e,t){return e+(0===parseInt(t[t.length-1])?1:0)},0),n=Object(b.Decimal)(t).div(e.length/100);return Object(b.Decimal)(100).minus(n).toString()},y=function(e){for(var t=Object(b.Decimal)(0),n=Object(b.Decimal)(-1/0),a=0;a<e.length;a+=1){var o=(n=e[a].greaterThan(n)?e[a]:n).minus(e[a]).div(n).times(100);t=o.greaterThan(t)?o:t}return t.toDecimalPlaces(2).toString()},E=n(11),O=n.n(E),S=function(e){return o.a.createElement("div",{id:"form-group row"},o.a.createElement("label",{className:"",htmlFor:e.name},o.a.createElement("h5",null,e.title,": ")),o.a.createElement("input",{type:"number",onChange:e.onChange,name:e.name,value:e.value,id:e.name,className:"form-control"}))},j=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(m.a)(this,Object(s.a)(t).call(this,e))).myRef=o.a.createRef(),n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){setTimeout(function(){document.querySelector(".js-plotly-plot").scrollIntoView({behavior:"smooth"})},10)}},{key:"render",value:function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(_,{data:this.props.data,duration:this.props.duration}),o.a.createElement(w,{data:this.props.data}))}}]),t}(o.a.Component),_=function(e){var t=Array.from({length:12*e.duration+1},function(e,t){return t/12}),n=[{x:t,y:e.data.median.map(function(e){return parseInt(e.toString())}),type:"scatter",name:"50th Percentile"},{x:t,y:e.data.buttom10.map(function(e){return parseInt(e.toString())}),type:"scatter",name:"10th Percentile"},{x:t,y:e.data.top10.map(function(e){return parseInt(e.toString())}),type:"scatter",name:"90th Percentile"}];return o.a.createElement(O()(Plotly),{data:n,config:{displaylogo:!1,displayModeBar:!1,scrollZoom:!1},layout:{title:{text:"Simulated Portfolio Balances"},legend:{orientation:"h"},autosize:!0,margin:{r:30,l:40,t:80,b:40}},useResizeHandler:!0,style:{width:"100%",height:"100%",overflow:"auto"}})},w=function(e){var t=e.data.median.length;return b.Decimal.set({rounding:0}),o.a.createElement("div",{className:"table-responsive"},o.a.createElement("table",{className:"table table-striped table-hover"},o.a.createElement("thead",null,o.a.createElement("tr",null,o.a.createElement("th",{scope:"col"}),o.a.createElement("th",{scope:"col"},"10th Percentile "),o.a.createElement("th",{scope:"col"},"50th Percentile "),o.a.createElement("th",{scope:"col"},"90th Percentile "))),o.a.createElement("tbody",null,o.a.createElement("tr",null,o.a.createElement("th",{scope:"row"},"Ending Balance"),o.a.createElement("td",null,e.data.buttom10[t-1].round().toString()," "),o.a.createElement("td",null,e.data.median[t-1].round().toString()),o.a.createElement("td",null,e.data.top10[t-1].round().toString()," ")),o.a.createElement("tr",null,o.a.createElement("th",{scope:"row"},"Maximum Drawdown"),o.a.createElement("td",null,"-".concat(y(e.data.buttom10),"%")," "),o.a.createElement("td",null,"-".concat(y(e.data.median),"%")),o.a.createElement("td",null,"-".concat(y(e.data.top10),"%")," ")))))},C=function(e){function t(){return Object(c.a)(this,t),Object(m.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){setTimeout(this.props.handler,50)}},{key:"render",value:function(){return o.a.createElement("button",{type:"submit",id:"submit-btm",className:"btn btn-primary",disabled:!0},o.a.createElement("i",{className:"fas fa-spinner"})," Simulating")}}]),t}(o.a.Component),D=function(e){return o.a.createElement("form",{className:"form-horizontal",onSubmit:e.handleSubmit},o.a.createElement(S,{name:"years_to_ret",value:e.state.years_to_ret,onChange:e.handler,title:"Years to Retirement"}),o.a.createElement(S,{name:"duration",value:e.state.duration,onChange:e.handler,title:"Duration of Simulation"}),o.a.createElement(S,{name:"savings",value:e.state.savings,onChange:e.handler,title:"Current Savings"}),o.a.createElement(S,{name:"contribution",value:e.state.contribution,onChange:e.handler,title:"Monthly Contribution until Retirement"}),o.a.createElement(S,{name:"ret_income",value:e.state.ret_income,onChange:e.handler,title:"Target Annual Retirement Income"}),o.a.createElement(S,{name:"beg_equity",value:e.state.allocation.beg_equity,onChange:e.handleAllocChange,title:"Current Equity Allocation (%)"}),o.a.createElement(S,{name:"beg_bond",value:e.state.allocation.beg_bond,onChange:e.handleAllocChange,title:"Current Fixed Income Allocation (%)"}),o.a.createElement(S,{name:"end_equity",value:e.state.allocation.end_equity,onChange:e.handleAllocChange,title:"Final Equity Allocation (%)"}),o.a.createElement(S,{name:"end_bond",value:e.state.allocation.end_bond,onChange:e.handleAllocChange,title:"Final Fixed Income Allocation (%)"}),o.a.createElement("div",{id:"logger"}),e.state.loading?o.a.createElement(C,{data:e.state,handler:e.handleSim}):o.a.createElement("button",{type:"submit",id:"submit-btn",className:"btn btn-primary"},"Simulate!"))},q=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(m.a)(this,Object(s.a)(t).call(this,e))).handleSubmit=n.handleSubmit.bind(Object(d.a)(n)),n.handleChange=n.handleChange.bind(Object(d.a)(n)),n.handleAllocChange=n.handleAllocChange.bind(Object(d.a)(n)),n.handleSim=n.handleSim.bind(Object(d.a)(n)),n.state={loaded:!1,loading:!1,years_to_ret:"30",duration:"50",savings:"50000",contribution:"1000",ret_income:"100000",allocation:{beg_equity:"60",beg_bond:"40",end_equity:"20",end_bond:"80"},returns:[],outcomes:{}},n}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){fetch("http://127.0.0.1:8000/api/index/").then(function(e){if(!e.ok)throw new Error("Network response was not ok.");return e.json()}).then(function(e){var t=[],n=[];if(e.forEach(function(e){"SPX"===e.index_name?t.push(e.mo_return):n.push(e.mo_return)}),n.length<1||t.length<1)throw new Error("API call returned no data");var a={bond:n,equity:t};window.localStorage.setItem("asset_data",JSON.stringify(a))}).catch(function(e){console.log(e),document.getElementById("logger").innerHTML=e})}},{key:"handleSim",value:function(){var e=this;v(this.state).then(function(t){window.localStorage.setItem("scenarios",JSON.stringify(t)),e.setState({loaded:!0,loading:!1,outcomes:{median:t[Math.floor(t.length/2)],buttom10:t[Math.floor(t.length/10)],top10:t[Math.floor(t.length/10*9)],survival:p(t)}})})}},{key:"handleSubmit",value:function(e){e.preventDefault(),this.setState({loading:!0})}},{key:"handleChange",value:function(e){var t=e.target.name,n=Math.max(e.target.value,0);this.setState(Object(i.a)({},t,n.toString()))}},{key:"handleAllocChange",value:function(e){var t=e.target.name,n=Math.max(e.target.value,0),a=this.state.allocation;a[t]=n.toString(),this.setState({allocation:a})}},{key:"render",value:function(){return o.a.createElement("div",{className:"container-fluid"},o.a.createElement(D,{handleSubmit:this.handleSubmit,handler:this.handleChange,state:this.state,handleAllocChange:this.handleAllocChange,handleSim:this.handleSim}),this.state.loaded&&o.a.createElement(j,{title:this.state.outcomes.survival,data:this.state.outcomes,duration:this.state.duration}))}}]),t}(o.a.Component);var k=function(){return o.a.createElement("div",{className:"container"},o.a.createElement(q,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(o.a.createElement(k,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[12,1,2]]]);
//# sourceMappingURL=main.8e9dd052.chunk.js.map